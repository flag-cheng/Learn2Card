# Agent B PRD：Web 翻卡介面

## 使命
提供簡單 Web 介面載入 Agent A 的 JSON 輸出，支援分頁/序列翻卡、主題瀏覽與統計展示，作為示範用的可視化大綱。

## 技術棧與環境
> 📋 **請參閱**：技術棧與環境設定的完整規範請參考 `.cursor/rules/frontend-rule.mdc`

⚠️ **重要**：本專案已有前端基礎架構，必須在現有專案上擴充，不得重新建立專案。

- **專案位置**：`frontend/` 目錄  
- **技術棧**：React 18 + TypeScript + Vite 5
- **套件管理**：npm
- **現有基礎**：已實作卡片瀏覽介面（`src/App.tsx`），需在此基礎上擴充

## 範圍
- **資料來源輸入（嚴格限制）**：  
  - **僅支援**上傳 `.txt` 或 `.md` 檔案  
  - **或**提供文字框讓使用者直接貼上純文字內容  
  - **不支援 URL 輸入**、網頁抓取或其他格式檔案（如 PDF、DOCX 等）  
  - demo 版可預設載入放在 public 根目錄的 `deck.json` 範例檔  
- **資料處理**：呼叫 Agent A 的核心管線處理文字，取得 JSON 輸出；或直接載入已處理好的 JSON 檔案  
- 卡片呈現：標題 + 1–5 摘要（目標 3–5），上一張/下一張、分頁控制、鍵盤左右鍵。  
- 統計區：重點/主題/卡片數。  
- 主題瀏覽：依 topic 跳轉或篩選。  
- 錯誤提示：資料格式錯誤或載入失敗的提示。

## 資料介面（JSON）
- `cards`: [{id, topicId, title, bullets[]}]  
- `topics`: [{id, title, memberIds[]}]  
- `stats`: {totalKeypoints, totalTopics, totalCards}  
- 可附帶 `paragraphs` / `keypoints` 以備後續顯示。

## 功能需求
1) **輸入方式（嚴格限制）**：  
   - 提供檔案上傳按鈕，**僅接受 `.txt` 和 `.md` 格式**  
   - 或提供多行文字輸入框，讓使用者直接貼上純文字內容  
   - **不得**提供 URL 輸入欄位或網頁抓取功能  
   - 顯示載入中狀態與進度提示  
2) 導航：上一張/下一張；分頁（例如每頁 N 張）；鍵盤左右鍵快捷。  
3) 主題跳轉：依 topic 過濾/跳轉，顯示主題標題。  
4) 統計展示：同步顯示重點/主題/卡片數。  
5) 錯誤處理：  
   - 檔案格式驗證：若上傳非 txt/md 檔案，顯示明確錯誤訊息  
   - JSON schema 驗證：Agent A 輸出的 JSON 格式錯誤時提供可讀提示  
   - 空內容處理：文字為空或無效時的友善提示  
6) UI：簡潔、可讀，行高、對比度足夠。

## 非功能需求（品質與效能要求）
> 💡 **說明**：「非功能需求」指的不是具體功能，而是系統的品質、效能、相容性等要求。

- **瀏覽器相容性**：優先支援 Chrome/Edge 桌面版，在 Windows 環境下正常運作。  
- **部署方式**：使用 Vite 的開發伺服器（`npm run dev`），或打包成靜態檔案（`npm run build`）。  
- **回應速度**：大檔案處理時要顯示 loading 狀態，避免長時間白屏或無回應。  
- **錯誤處理**：任何錯誤（檔案格式、JSON 解析、API 呼叫失敗等）都要有清楚的使用者提示。  
- **程式碼品質**：使用 TypeScript 型別檢查，確保型別安全。

## 實作指引與限制
> 📋 **請參閱**：通用 Frontend 開發規則請參考 `.cursor/rules/frontend-rule.mdc`

### 本模組特定限制
#### 必須遵守
- **輸入格式**：只接受 `.txt` 和 `.md` 檔案上傳，或純文字貼上  
- **檔案驗證**：上傳時檢查副檔名，非 txt/md 要明確拒絕並顯示錯誤訊息  
- **文字處理**：讀取檔案內容後，將純文字字串傳遞給 Agent A 的管線函式  
- **UI 元件**：使用 `<input type="file" accept=".txt,.md">` 限制檔案選擇器  

#### 不得實作
- ❌ 不得提供 URL 輸入欄位  
- ❌ 不得實作網頁抓取、爬蟲或任何 URL 內容讀取功能  
- ❌ 不得支援 PDF、DOCX、HTML 等其他檔案格式（僅限 txt/md）  

## 驗收標準
- **專案完整性**：`frontend/` 目錄結構維持不變，`npm install` 和 `npm run dev` 能正常執行。  
- **現有功能保留**：原有的卡片瀏覽、主題切換、統計顯示功能繼續運作正常。  
- **新增輸入功能**：能上傳 .txt 或 .md 檔案，或貼上純文字，成功呼叫 Agent A 處理並顯示卡片。  
- 能載入範例 JSON 並正常翻卡、分頁、群組跳轉。  
- 統計數據與 JSON 一致；錯誤 JSON 能顯示提示。  
- 上傳非 txt/md 檔案時，顯示明確的格式錯誤提示。  
- **確認無 URL 輸入欄位**，不支援網頁抓取功能。  
- 主要操作可被示範（滑鼠/鍵盤）。

## 風險與緩解
- JSON 版本差異：固定 schema，必要時增加向後相容映射。  
- 大檔渲染：使用分頁/虛擬列表策略，顯示 loading。  
- 瀏覽器差異：優先桌面 Chrome/Edge。

